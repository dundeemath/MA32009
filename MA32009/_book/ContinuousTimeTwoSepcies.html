<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MA32009 - 4&nbsp; Multi species population dynamics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./SinglePopODEMOdels.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./SinglePopODEMOdels.html">Continuous time</a></li><li class="breadcrumb-item"><a href="./ContinuousTimeTwoSepcies.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multi species population dynamics</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MA32009</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/dundeemath/MA32009/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./MA32009.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Discrete time</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MA32009-SinglePopDiscreteTimea.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Single species population dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DiscreteModels2d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Multi species population dynamics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Continuous time</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SinglePopODEMOdels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Single species population dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ContinuousTimeTwoSepcies.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multi species population dynamics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#general-tools" id="toc-general-tools" class="nav-link active" data-scroll-target="#general-tools"><span class="header-section-number">4.1</span> General tools</a>
  <ul class="collapse">
  <li><a href="#steady-states" id="toc-steady-states" class="nav-link" data-scroll-target="#steady-states"><span class="header-section-number">4.1.1</span> Steady states</a></li>
  <li><a href="#linear-stability-analysis" id="toc-linear-stability-analysis" class="nav-link" data-scroll-target="#linear-stability-analysis"><span class="header-section-number">4.1.2</span> Linear stability analysis</a></li>
  <li><a href="#nullclines" id="toc-nullclines" class="nav-link" data-scroll-target="#nullclines"><span class="header-section-number">4.1.3</span> Nullclines</a></li>
  <li><a href="#poincaire-bendixson-theorem" id="toc-poincaire-bendixson-theorem" class="nav-link" data-scroll-target="#poincaire-bendixson-theorem"><span class="header-section-number">4.1.4</span> Poincaire-Bendixson theorem</a></li>
  <li><a href="#dulac-criterion" id="toc-dulac-criterion" class="nav-link" data-scroll-target="#dulac-criterion"><span class="header-section-number">4.1.5</span> Dulac criterion</a></li>
  </ul></li>
  <li><a href="#the-lotka-voltera-model" id="toc-the-lotka-voltera-model" class="nav-link" data-scroll-target="#the-lotka-voltera-model"><span class="header-section-number">4.2</span> The Lotka-Voltera model</a>
  <ul class="collapse">
  <li><a href="#nondimensionalisation" id="toc-nondimensionalisation" class="nav-link" data-scroll-target="#nondimensionalisation"><span class="header-section-number">4.2.1</span> Nondimensionalisation</a></li>
  <li><a href="#numerical-solutions" id="toc-numerical-solutions" class="nav-link" data-scroll-target="#numerical-solutions"><span class="header-section-number">4.2.2</span> Numerical solutions</a></li>
  <li><a href="#steady-states-1" id="toc-steady-states-1" class="nav-link" data-scroll-target="#steady-states-1"><span class="header-section-number">4.2.3</span> Steady states</a></li>
  <li><a href="#linear-stability" id="toc-linear-stability" class="nav-link" data-scroll-target="#linear-stability"><span class="header-section-number">4.2.4</span> Linear stability</a></li>
  <li><a href="#solutions-in-the-phase-plane" id="toc-solutions-in-the-phase-plane" class="nav-link" data-scroll-target="#solutions-in-the-phase-plane"><span class="header-section-number">4.2.5</span> Solutions in the phase plane</a></li>
  <li><a href="#direct-integration" id="toc-direct-integration" class="nav-link" data-scroll-target="#direct-integration"><span class="header-section-number">4.2.6</span> Direct integration</a></li>
  </ul></li>
  <li><a href="#competition" id="toc-competition" class="nav-link" data-scroll-target="#competition"><span class="header-section-number">4.3</span> Competition</a>
  <ul class="collapse">
  <li><a href="#nondimensionalisation-1" id="toc-nondimensionalisation-1" class="nav-link" data-scroll-target="#nondimensionalisation-1"><span class="header-section-number">4.3.1</span> Nondimensionalisation</a></li>
  <li><a href="#steady-states-2" id="toc-steady-states-2" class="nav-link" data-scroll-target="#steady-states-2"><span class="header-section-number">4.3.2</span> Steady states</a></li>
  <li><a href="#nullclines-1" id="toc-nullclines-1" class="nav-link" data-scroll-target="#nullclines-1"><span class="header-section-number">4.3.3</span> Nullclines</a></li>
  <li><a href="#linear-stability-1" id="toc-linear-stability-1" class="nav-link" data-scroll-target="#linear-stability-1"><span class="header-section-number">4.3.4</span> Linear stability</a></li>
  <li><a href="#phase-portrait" id="toc-phase-portrait" class="nav-link" data-scroll-target="#phase-portrait"><span class="header-section-number">4.3.5</span> Phase portrait</a></li>
  <li><a href="#insight" id="toc-insight" class="nav-link" data-scroll-target="#insight"><span class="header-section-number">4.3.6</span> Insight</a></li>
  </ul></li>
  <li><a href="#symbiosismutualism" id="toc-symbiosismutualism" class="nav-link" data-scroll-target="#symbiosismutualism"><span class="header-section-number">4.4</span> Symbiosis/Mutualism</a>
  <ul class="collapse">
  <li><a href="#nondimensionalisation-2" id="toc-nondimensionalisation-2" class="nav-link" data-scroll-target="#nondimensionalisation-2"><span class="header-section-number">4.4.1</span> Nondimensionalisation</a></li>
  <li><a href="#steady-states-3" id="toc-steady-states-3" class="nav-link" data-scroll-target="#steady-states-3"><span class="header-section-number">4.4.2</span> Steady states</a></li>
  <li><a href="#nullclines-2" id="toc-nullclines-2" class="nav-link" data-scroll-target="#nullclines-2"><span class="header-section-number">4.4.3</span> Nullclines</a></li>
  <li><a href="#linear-stability-2" id="toc-linear-stability-2" class="nav-link" data-scroll-target="#linear-stability-2"><span class="header-section-number">4.4.4</span> Linear stability</a></li>
  <li><a href="#insight-1" id="toc-insight-1" class="nav-link" data-scroll-target="#insight-1"><span class="header-section-number">4.4.5</span> Insight</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multi species population dynamics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this chapter we consider models of interacitng populations.</p>
<p>Let <span class="math inline">\(u=u(t)\)</span> and <span class="math inline">\(v=v(t)\)</span> represent populations of two different species at continuous time <span class="math inline">\(t\)</span>. Suppose that <span class="math inline">\(u(t)\)</span> and <span class="math inline">\(v(t)\)</span> satisfy the ordinary differential equations <span id="eq-twovariablfegen"><span class="math display">\[
\begin{aligned}
\frac{du}{dt}&amp;=f(u,v),  \nonumber \\
\frac{dv}{dt}&amp;=g(u,v).
\end{aligned}
\tag{4.1}\]</span></span></p>
<p>In this section we will consider particular forms for <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> that represent different types of inter species interaction. Before considering particular examples, we develop some general techniques for analysing equations of the form <a href="#eq-twovariablfegen">Equation&nbsp;<span>4.1</span></a>.</p>
<section id="general-tools" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="general-tools"><span class="header-section-number">4.1</span> General tools</h2>
<section id="steady-states" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="steady-states"><span class="header-section-number">4.1.1</span> Steady states</h3>
<p><span class="math inline">\((u^*,v^*)\)</span> is defined to be a steady state of <a href="#eq-twovariablfegen">Equation&nbsp;<span>4.1</span></a> if</p>
<p><span class="math display">\[
f(u^*,v^*)=g(u^*,v^*)=0.
\]</span></p>
<p>Hence, by definition, the time derivatives of <span class="math inline">\(u(t)\)</span> and <span class="math inline">\(v(t)\)</span> are both zero at <span class="math inline">\((u^*,v^*)\)</span>. As was the case for single species models, steady states are obtained by solving algebraic equations.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compute the steady states of the system of ODEs <span class="math display">\[
\begin{aligned}
\frac{du}{dt}&amp;=1-u,  \nonumber \\
\frac{dv}{dt}&amp;=1-uv-v.
\end{aligned}
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Suppose <span class="math inline">\((u^*,v^*)\)</span> is a steady state. Hence <span class="math display">\[
0=1-u^*
\]</span> and <span class="math display">\[
0=1-u^*v^*-v^*
\]</span> The steady state is <span class="math inline">\((1,1/2)\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="linear-stability-analysis" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="linear-stability-analysis"><span class="header-section-number">4.1.2</span> Linear stability analysis</h3>
<p>Suppose that <span class="math inline">\((u^*,v^*)\)</span> is a steady state of equations <a href="#eq-twovariablfegen">Equation&nbsp;<span>4.1</span></a>.</p>
<p>We consider a change of dependent variables such that</p>
<p><span class="math display">\[
u(t)=u^*+ \hat{u}(t)  \  \  \textrm{and} \ \ v(t)=v^*+\hat{v}(t),
\]</span></p>
<p>where <span class="math inline">\(\hat{u}(t)\)</span> and <span class="math inline">\(\hat{v}(t)\)</span> are perturbations about the steady state.</p>
<p>Rewriting equation <a href="#eq-twovariablfegen">Equation&nbsp;<span>4.1</span></a> in the transformed variables yields</p>
<p><span id="eq-twovariablfegentrans"><span class="math display">\[
\begin{aligned}
\frac{d\hat{u}}{dt}&amp;=f(u^*+\hat{u},v^*+\hat{v}),  \nonumber \\
\frac{d\hat{v}}{dt}&amp;=g(u^*+\hat{u},v^*+\hat{v}).
\end{aligned}
\tag{4.2}\]</span></span></p>
<p>Making Taylor expansions about <span class="math inline">\((u^*,v^*)\)</span> yields the linearised equations</p>
<p><span id="eq-twovariablfegenlin"><span class="math display">\[
\begin{aligned}
\frac{d\hat{u}}{dt}=\frac{\partial f}{\partial u}_{|(u^*,v^*)} \hat{u} +  \frac{\partial f}{\partial v}_{|(u^*,v^*)}  \hat{v} + h.o.t, \nonumber\\
\frac{d\hat{v}}{dt}=\frac{\partial g}{\partial u}_{|(u^*,v^*)}  \hat{u} +  \frac{\partial g}{\partial v}_{|(u^*,v^*)}  \hat{v} + h.o.t. \nonumber
\end{aligned}
\tag{4.3}\]</span></span></p>
<p>Upon making the assumption that the perturbations about the steady state are small, the leading order terms are linear and higher order terms are neglected. Defining</p>
<p><span class="math display">\[
\mathbf{w}=\left
(\begin{array}{r}
\hat{u} \\
\hat{v}
\end{array}\right),
\]</span></p>
<p>yields the system of linear ODEs given by</p>
<p><span id="eq-linearsystem2d"><span class="math display">\[
\frac{d \mathbf{w}}{dt}= A \mathbf{w},
\tag{4.4}\]</span></span></p>
<p>where the matrix <span class="math inline">\(A\)</span>, known as the Jacobian matrix, takes the form</p>
<p><span class="math display">\[
A=\left(\begin{array}{rr}
\frac{\partial f}{\partial u}&amp;\frac{\partial f}{\partial v} \\ \frac{\partial g}{\partial u}&amp;\frac{\partial g}{\partial v} \end{array}\right)_{(u^*,v^*)}. \qquad
\]</span></p>
<p>The linear system arrived upon in <a href="#eq-linearsystem2d">Equation&nbsp;<span>4.4</span></a> was encountered previously in Differential Equations (MA31002). We summarise the important results here. Seeking a solution of <a href="#eq-linearsystem2d">Equation&nbsp;<span>4.4</span></a> of the form</p>
<p><span class="math display">\[
\mathbf{w}=\mathbf{v}e^{\lambda t}
\]</span></p>
<p>one obtains the characteristic equation</p>
<p><span class="math display">\[
\lambda^2 -\lambda \mathrm{tr}(A)+\det(A)=0,
\]</span> which has solutions</p>
<p><span class="math display">\[
\lambda = \frac{\mathrm{tr}{A}\pm \sqrt{\mathrm{tr}{A}^2-4\det{A}}}{2}.
\]</span></p>
<p>Whilst a complete classification of the linear stability of a steady state can be obtained by explicitly calculating the eigenvalues, in many cases it is sufficient to deduce whether or not a steady state is stable or unstable. This can be achieved by calculating the determinant and trace of the Jacobian matrix (<span class="math inline">\(\det(A)\)</span> and <span class="math inline">\(\mathrm{tr}(A)\)</span>, respectively) and referring to Figure <span class="math inline">\(\ref{TDplane}\)</span>.</p>
<!--\begin{figure}
\centering
\includegraphics[scale=0.5]{TDplane.eps} 
\caption{Classifying linear stability in the trace-determinant plane.}
\label{TDplane}
\end{figure}
-->
<p>The different cases can be categorised as follows:</p>
<ul>
<li><p><span class="math inline">\(\det(A)&lt;0\)</span> There is one positive and one negative real eigenvalue. Hence the steady state is a saddle which is unstable.</p></li>
<li><p><span class="math inline">\(\det(A)&gt;0\)</span> The steady state can be either stable or unstable, depending on <span class="math inline">\(\mathrm{tr}(A)\)</span> (and the real part of the eigenvalues).</p>
<ul>
<li>If <span class="math inline">\(\mathrm{tr}(A)&gt;0\)</span>, the steady state is unstable.
<ul>
<li>If <span class="math inline">\(\mathrm{tr}(A)^2&gt;4 \det(A)\)</span>, it is an unstable node.</li>
<li>If <span class="math inline">\(\mathrm{tr}(A)^2&lt;4 \det(A)\)</span> it is an unstable spiral.</li>
</ul></li>
<li>If <span class="math inline">\(\mathrm{tr}(A)&lt;0\)</span>, the steady state is stable.
<ul>
<li>If <span class="math inline">\(\mathrm{tr}(A)^2&gt;4 \det(A)\)</span>, it is an stable node.</li>
<li>If <span class="math inline">\(\mathrm{tr}(A)^2&lt;4 \det(A)\)</span>, it is an stable spiral.</li>
</ul></li>
</ul></li>
</ul>
<p>These different cases can be distinguished in the trace-determinant plane plotted in Figure <span class="math inline">\(\ref{TDplane}\)</span>.</p>
<p>Note that it can be shown rigorously that the linear stability of the nonlinear system is equivalent to that of the linearised system in all cases except when the steady state is a centre. In this case, nonlinear stability analysis is required to determine the stability of the nonlinear system.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Deduce, by considering the form for the eigenvalues that, for example, the conditions <span class="math inline">\(\det(A)&gt;0\)</span>, <span class="math inline">\(\mathrm{tr}(A)&gt;0\)</span> with <span class="math inline">\(\mathrm{tr}(A)^2&lt;4 \det(A)\)</span> imply that the steady state is an unstable spiral.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The eigenvalues are given by <span class="math display">\[
\lambda = \frac{\mathrm{tr}{A}\pm \sqrt{\mathrm{tr}{A}^2-4\det{A}}}{2}
\]</span> The condition<span class="math inline">\(\det(A)&gt;0\)</span> excludes the case that the eigenvalues are real but have opposite signs (i.e.&nbsp;it cannot be a saddle point).</p>
<p>The condition <span class="math inline">\(\mathrm{tr}(A)&gt;0\)</span> implies that the real part of both eigenvalues are positive (i.e.&nbsp;the steady state is unstable).</p>
<p>The condition <span class="math inline">\(\mathrm{tr}(A)^2&lt;4 \det(A)\)</span> implies that the eigenvalue are complex. Hence <span class="math display">\[
\lambda_{\pm}=\mu\pm i\omega \ \ \
\]</span> and the solution of the system can be written <span class="math display">\[
e^{\lambda t} = e^{(\mu+i\omega) t} = e^{\mu t}e^{i\omega t}.
\]</span> Thus the magnitude of perturbation grows but it oscillates about the steady state. Hence the steady state is an unstable spiral.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compute the Jacobian matrix for the system of ODEs <span class="math display">\[
\begin{aligned}
\frac{du}{dt}&amp;=1-u,  \nonumber \\
\frac{dv}{dt}&amp;=1-uv-v.
\end{aligned}
\]</span> Evaluate the Jacobian matrix at the steady state and hence determine its linear stability.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The Jacobian is given by <span class="math display">\[
A=\left(\begin{array}{rr} -1&amp;0 \\ -v &amp;-u-1 \end{array}\right).
\]</span> At (1,1/2) <span class="math display">\[
A=\left(\begin{array}{rr} -1&amp;0 \\ -\frac{1}{2} &amp;-2 \end{array}\right).
\]</span> In this case <span class="math display">\[
tr(A)=-3
\]</span> and <span class="math display">\[
\det(A)=2
\]</span> Hence the steady state is stable. As <span class="math display">\[
tr(A)^2-4\det(A)=9-8=1,
\]</span> it is a stable node.</p>
</div>
</div>
</div>
</section>
<section id="nullclines" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="nullclines"><span class="header-section-number">4.1.3</span> Nullclines</h3>
<p>Nullclines of the equations <a href="#eq-twovariablfegen">Equation&nbsp;<span>4.1</span></a> are given by the curves <span class="math display">\[
f(u,v)=0
\]</span> and <span class="math display">\[
g(u,v)=0,
\]</span> respectively. Note that steady states arise at the intersection of nullclines.</p>
<p>Using the <span class="math inline">\(u\)</span> nullclines we identify domains of the phase plane where <span class="math inline">\(du/dt &gt;0\)</span> and <span class="math inline">\(du/dt &lt;0\)</span>.</p>
<p>Similarly, using the <span class="math inline">\(v\)</span> nullcline we identify domains of the phase plane where <span class="math inline">\(dv/dt &gt;0\)</span> and <span class="math inline">\(dv/dt &lt;0\)</span>.</p>
<p>The nullclines can be used to help identify confined sets and hence apply the Poincaire-Bendixson theorem.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sketch the nullclines of the system of ODEs <span class="math display">\[
\begin{aligned}
\frac{du}{dt}&amp;=1-u,  \nonumber \\
\frac{dv}{dt}&amp;=1-uv-v.
\end{aligned}
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <span class="math inline">\(u\)</span> nullcline is <span class="math inline">\(u=1\)</span>. The <span class="math inline">\(v\)</span> nullcline is <span class="math inline">\(v=1/(1+u)\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="poincaire-bendixson-theorem" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="poincaire-bendixson-theorem"><span class="header-section-number">4.1.4</span> Poincaire-Bendixson theorem</h3>
<p>Suppose that the system of equations <span id="eq-xygenphaseplane"><span class="math display">\[
\frac{du}{dt}=f(u,v), \ \ \ \ \frac{dv}{dt}=g(u,v)
\tag{4.5}\]</span></span> possesses a confined set (i.e.&nbsp;a bounded domain in the phase plane upon which the derivative field points into the domain) that contains an unstable node or spiral. Any trajectory cannot leave the confined set, nor can it tend to the unstable steady state. The Poincaire-Bendixson theorem states that as <span class="math inline">\(t\rightarrow \infty\)</span>, the trajectory will tend towards a limit cycle.</p>
</section>
<section id="dulac-criterion" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="dulac-criterion"><span class="header-section-number">4.1.5</span> Dulac criterion</h3>
<p>Suppose <span class="math inline">\(D\)</span> is a simply connected region in the plane and that there exists a function <span class="math inline">\(B(x,y)\)</span>, continuously differentiable on <span class="math inline">\(D\)</span>, such that the expression <span class="math display">\[
\frac{\partial }{\partial u} (Bf) + \frac{\partial }{\partial v} (Bg)
\]</span> is not identically zero and does not change sign in D. Then there are no closed orbits in <span class="math inline">\(D\)</span>.</p>
</section>
</section>
<section id="the-lotka-voltera-model" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="the-lotka-voltera-model"><span class="header-section-number">4.2</span> The Lotka-Voltera model</h2>
<p>Suppose that <span class="math inline">\(N(t)\)</span> and <span class="math inline">\(P(t)\)</span> represent the prey and predator population densities at time <span class="math inline">\(t\)</span>, respectively. Consider a model of the form <span class="math display">\[
   \begin{aligned}
   \frac{dN }{dt} &amp;= aN -bNP, \nonumber \\
      \frac{dP }{dt} &amp;= cNP -dP,
\end{aligned}
\]</span> where <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> are positive constants.</p>
<section id="nondimensionalisation" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="nondimensionalisation"><span class="header-section-number">4.2.1</span> Nondimensionalisation</h3>
<p>Nondimensionalising with <span class="math display">\[
n=\frac{N}{\tilde{N}}, \ \ \ \ p=\frac{P}{\tilde{P}}  \ \ \textrm{and} \ \ \tau= \frac{t}{\tilde{T}},
\]</span></p>
<p>yields, after changing variables, <span class="math display">\[  
\begin{aligned}
   \frac{dn }{d\tau} &amp;= \tilde{T}an -b\tilde{T} \tilde{P}np,  \nonumber \\
      \frac{dp }{d\tau} &amp;= c\tilde{N} \tilde{T}np -d\tilde{T}p.
\end{aligned}
\]</span> Choosing the dimensional scalings</p>
<p><span class="math display">\[
\tilde{T}=1/a, \ \ \ \tilde{P}=a/b  \ \ \ \textrm{and} \ \ \ \tilde{N}=d/c,
\]</span></p>
<p>yields</p>
<p><span id="eq-lotkavolterranondim"><span class="math display">\[
\begin{aligned}
\frac{dn }{d\tau} &amp;= n(1-p) = f(n,p), \nonumber \\
\frac{dp }{d\tau} &amp;=\alpha p(n-1)  = g(n,p),
\end{aligned}
\tag{4.6}\]</span></span></p>
<p>where <span class="math inline">\(\alpha=d/a\)</span>. Note that all variables and parameter are without dimensions.</p>
</section>
<section id="numerical-solutions" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="numerical-solutions"><span class="header-section-number">4.2.2</span> Numerical solutions</h3>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>alpha<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs_lv_model(x,t):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  rhs<span class="op">=</span>np.zeros_like(x)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  n<span class="op">=</span>x[<span class="dv">0</span>]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  p<span class="op">=</span>x[<span class="dv">1</span>]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  dn_dt<span class="op">=</span>n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  dp_dt<span class="op">=</span>alpha<span class="op">*</span>p<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  rhs[<span class="dv">0</span>]<span class="op">=</span>dn_dt</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  rhs[<span class="dv">1</span>]<span class="op">=</span>dp_dt</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> rhs</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>init_cond<span class="op">=</span>[<span class="fl">0.5</span>,<span class="fl">0.5</span>]</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>alpha<span class="op">=</span><span class="fl">2.0</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> odeint(rhs_lv_model, init_cond,t)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>n<span class="op">=</span>sol1[:,<span class="dv">0</span>]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span>sol1[:,<span class="dv">1</span>]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>plt.plot(t, n, <span class="st">'b'</span>,t,p,<span class="st">'r'</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'n'</span>,<span class="st">'p'</span>],loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'t'</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-lv-numsol" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ContinuousTimeTwoSepcies_files/figure-html/fig-lv-numsol-output-1.png" width="571" height="429" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: Numerical solution of Lotka-Volterra model</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="steady-states-1" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="steady-states-1"><span class="header-section-number">4.2.3</span> Steady states</h3>
<p>The steady-states of equation <a href="#eq-lotkavolterranondim">Equation&nbsp;<span>4.6</span></a> are identified by seeking solutions of</p>
<p><span class="math display">\[
f(n^*,p^*)=g(n^*,p^*)=0.
\]</span></p>
<p>Hence</p>
<p><span class="math display">\[
n^*(1-p^*)= 0 \ \ \ \ \ \alpha p^*(n^*-1).
\]</span></p>
<p>The first of these equations has solutions either</p>
<p><span class="math display">\[
n^*=0 \ \ \  \textrm{or} \ \ \  p^* =1.
\]</span></p>
<p>Substituting for <span class="math inline">\(n^*=0\)</span> in the second equation yields <span class="math inline">\(p^*=0\)</span>. Hence one steady state is <span class="math inline">\((0,0)\)</span>. Substituting for <span class="math inline">\(p^*=1\)</span> in the second equation yields <span class="math inline">\(n^*=1\)</span>. Hence a second steady state is (1,1).</p>
</section>
<section id="linear-stability" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="linear-stability"><span class="header-section-number">4.2.4</span> Linear stability</h3>
<p>The linear stability of the steady states is described by the Jacobian matrix <span class="math display">\[
A=\left(\begin{array}{rr}
\frac{\partial f}{\partial n}&amp;\frac{\partial f}{\partial p} \\ \frac{\partial g}{\partial n}&amp;\frac{\partial g}{\partial p} \end{array}\right)_{(n^*,p^*)} = \left(\begin{array}{rr}
1-p&amp;-n \\ \alpha p &amp;\alpha (n-1) \end{array}\right)_{(n^*,p^*)}
\]</span></p>
<p>Evaluating at (0,0) yields</p>
<p><span class="math display">\[
A=\left(\begin{array}{rr} 1&amp;0 \\ 0 &amp;-\alpha \end{array}\right),
\]</span></p>
<p>Hence the eigenvalues of <span class="math inline">\(A\)</span> are <span class="math inline">\(1\)</span> and <span class="math inline">\(-\alpha\)</span>. As <span class="math inline">\(\alpha&gt;0\)</span> the origin is a saddle. The eigenvectors are <span class="math inline">\([1, 0]\)</span> and $[0,1]. $</p>
<p>At (1,1) <span class="math display">\[
A=\left(\begin{array}{rr} 0&amp;-1 \\ \alpha &amp;0 \end{array}\right),
\]</span></p>
<p>and the eigenvalues are <span class="math inline">\(\pm i\sqrt{\alpha}\)</span>. Therefore the steady state at (1,1) is a centre.</p>
</section>
<section id="solutions-in-the-phase-plane" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="solutions-in-the-phase-plane"><span class="header-section-number">4.2.5</span> Solutions in the phase plane</h3>
<p>See Figure <a href="#fig-lv-numsol-phplane">Figure&nbsp;<span>4.2</span></a> for solution trajectories plotted in the phase plane using different initial conditions. Note the expected saddle like behaviour when trajectories that are close to the origin. Furthermore, note that the different initial conditions result in distinct closed loops and that the inner-most loop, i.e.&nbsp;that closest to the steady-state (1,1), behaves like a centre, as expected given the linear stability analysis. However, far from the steady-state the solution trajectory deviates from the linearised model.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>alpha<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs_lv_model(x,t):</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  rhs<span class="op">=</span>np.zeros_like(x)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  n<span class="op">=</span>x[<span class="dv">0</span>]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  p<span class="op">=</span>x[<span class="dv">1</span>]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  dn_dt<span class="op">=</span>n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  dp_dt<span class="op">=</span>alpha<span class="op">*</span>p<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  rhs[<span class="dv">0</span>]<span class="op">=</span>dn_dt</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  rhs[<span class="dv">1</span>]<span class="op">=</span>dp_dt</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> rhs</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>init_cond1<span class="op">=</span>[<span class="fl">0.75</span>,<span class="fl">0.75</span>]</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>init_cond2<span class="op">=</span>[<span class="fl">0.15</span>,<span class="fl">0.15</span>]</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>init_cond3<span class="op">=</span>[<span class="fl">2.5</span>,<span class="fl">0.5</span>]</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>alpha<span class="op">=</span><span class="fl">2.0</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> odeint(rhs_lv_model, init_cond1,t)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> odeint(rhs_lv_model, init_cond2,t)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>sol3 <span class="op">=</span> odeint(rhs_lv_model, init_cond3,t)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>n<span class="op">=</span>sol1[:,<span class="dv">0</span>]</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span>sol1[:,<span class="dv">1</span>]</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>ss<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>plt.plot(sol1[:,<span class="dv">0</span>],sol1[:,<span class="dv">1</span>],sol2[:,<span class="dv">0</span>],sol2[:,<span class="dv">1</span>],sol3[:,<span class="dv">0</span>],sol3[:,<span class="dv">1</span>])</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>plt.plot(ss[<span class="dv">0</span>],ss[<span class="dv">1</span>],<span class="st">'k*'</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$n$'</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$p$'</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-lv-numsol-phplane" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ContinuousTimeTwoSepcies_files/figure-html/fig-lv-numsol-phplane-output-1.png" width="576" height="429" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.2: Numerical solution of Lotka-Volterra model</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="direct-integration" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="direct-integration"><span class="header-section-number">4.2.6</span> Direct integration</h3>
<p>The Lotka-Volterra equations are a special case as they are integrable. Trajectories in the phase plane satisfy the differential equation</p>
<p><span class="math display">\[
\frac{dp }{d n} = \frac{\alpha p (n-1)}{n(1-p)},
\]</span></p>
<p>Using separation of variables</p>
<p><span class="math display">\[
\int \frac{1-p}{p} dp  = \alpha  \int \frac{n-1}{n} dn.  
\]</span></p>
<p>Integration yields</p>
<p><span class="math display">\[
\ln p - p =  \alpha (n-\ln n) + H,
\]</span></p>
<p>where <span class="math inline">\(H\)</span> is a conserved quantity that this is determined by the initial conditions. As the equations take conservative form, the Lotka-Voltera model is said to be structurally unstable, as a small perturbation to the solution at a given point in the oscillatory cycle can result in large changes elsewhere in the cycle. For example, suppose the outermost limit cycle in Figure <a href="#fig-lv-numsol-phplane">Figure&nbsp;<span>4.2</span></a> is perturbed by a small amount at the point (1,0.1) onto its nearest limit cycle. Later in the cycle these two trajectories deviate by a large amount.</p>
</section>
</section>
<section id="competition" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="competition"><span class="header-section-number">4.3</span> Competition</h2>
<p>In models of competition, two or more species compete for the same resource or in some way inhibit each other’s growth. Letting <span class="math inline">\(N_1(t)\)</span> and <span class="math inline">\(N_2(t)\)</span> represent the population density of two species, we consider the ODEs <span class="math display">\[
\begin{aligned}
\frac{d N_1}{dt} &amp;= r_1N_1\left(1-\frac{N_1}{K_1}-b_{12}\frac{N_2}{K_1}\right), \nonumber \\
\frac{d N_2}{dt} &amp;= r_2N_2\left(1-\frac{N_2}{K_2}-b_{21}\frac{N_1}{K_2}\right),
\end{aligned}
\]</span> where <span class="math inline">\(r_1\)</span>, <span class="math inline">\(r_2\)</span>, <span class="math inline">\(K_1\)</span> and <span class="math inline">\(K_2\)</span> are positive constants. As before, the <span class="math inline">\(r's\)</span> are linear growth rates and the <span class="math inline">\(K\)</span>’s are carrying capacities. The parameters <span class="math inline">\(b_{12}\)</span> and <span class="math inline">\(b_{21}\)</span> measure the competitive effect of <span class="math inline">\(N_2\)</span> on <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_1\)</span> on <span class="math inline">\(N_2\)</span>, respectively.</p>
<section id="nondimensionalisation-1" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="nondimensionalisation-1"><span class="header-section-number">4.3.1</span> Nondimensionalisation</h3>
<p>After nondimensionalising using the change of variables</p>
<p><span class="math display">\[
n_1=\frac{N_1}{K_1} \ \ n_2=\frac{N_2}{K_2} \ \ \tau=\frac{t}{\frac{1}{r_1}},
\]</span></p>
<p>we obtain the equations</p>
<p><span id="eq-competitionnondim"><span class="math display">\[
\begin{aligned}
\frac{d n_1}{d\tau} &amp;= n_1\left(1- n_1-a_{12}n_2\right) = f(n_1,n_2), \nonumber \\
\frac{d n_2}{d\tau} &amp;= \rho n_2\left(1-n_2-a_{21}n_1\right) =g(n_1,n_2),
\end{aligned}
\tag{4.7}\]</span></span></p>
<p>where</p>
<p><span class="math display">\[
\rho=\frac{r_2}{r_1}, \ \ \ a_{12}=b_{12}\frac{K_2}{K_1}, \ \ \  a_{21}=b_{21}\frac{K_1}{K_2}.
\]</span></p>
</section>
<section id="steady-states-2" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="steady-states-2"><span class="header-section-number">4.3.2</span> Steady states</h3>
<p>The steady states of <a href="#eq-competitionnondim">Equation&nbsp;<span>4.7</span></a> are identified in the usual manner, i.e.&nbsp;by seeking <span class="math inline">\(({n_1}^*,{n_2}^*)\)</span> such that</p>
<p><span class="math display">\[
f({n_1}^*,{n_2}^*)=g({n_1}^*,{n_2}^*)=0.
\]</span></p>
<p>The steady state equations are <span class="math display">\[
{n_1}^*\left(1- {n_1}^*-a_{12}{n_2}^*\right)=0 \ \ \ \ {n_2}^*\left(1-{n_2}^*-a_{21}{n_1}^*\right)=0.
\]</span> The first equation has solution <span class="math display">\[
n_1^*=0
\]</span> or <span class="math display">\[
\left(1- {n_1}^*-a_{12}{n_2}^*\right) \implies n_2=\frac{1}{a_{12}}(1-n_1^*).
\]</span> Consider <span class="math inline">\(n_1^*=0\)</span>. Substitution in the second equation yields <span class="math display">\[
{n_2}^*\left(1-{n_2}^*\right)=0.
\]</span> Hence either <span class="math inline">\(n_2^*=0\)</span> or <span class="math inline">\(n_2^*=1\)</span>. Hence two steady states are <span class="math inline">\((0,0)\)</span> and <span class="math inline">\((0,1).\)</span> \ Now consider <span class="math inline">\(n_2^*=\frac{1}{a_{12}}(1-n_1^*)\)</span> with <span class="math inline">\(n_1^*\neq0\)</span>. \ Substitution in the second steady state equation yields <span class="math display">\[
\frac{1}{a_{12}}(1-n_1^*) \left(1- \frac{1}{a_{12}}(1-n_1^*) -a_{21}{n_1}^*\right)
\]</span> Hence either <span class="math inline">\(n_1^*=1\)</span> or <span class="math display">\[
\left(1- \frac{1}{a_{12}}(1-n_1^*) -a_{21}{n_1}^*\right)=0 \implies n_1^*=\frac{1-a_{12}}{1-a_{12}a_{21}}.
\]</span> In the case where <span class="math inline">\(n_1^*=1\)</span>, we find that <span class="math inline">\(n_2^*=0\)</span>. Hence the steady state is (1,0).</p>
<p>In the case where <span class="math display">\[
n_1^*=\frac{1-a_{12}}{1-a_{12}a_{21}}
\]</span> we find that <span class="math display">\[
n_2^*=\frac{1-a_{21}}{1-a_{12}a_{21}}
\]</span> Hence the steady state is <span class="math display">\[
\left(\frac{1-a_{12}}{1-a_{12}a_{21}},\frac{1-a_{21}}{1-a_{12}a_{21}}\right).
\]</span></p>
</section>
<section id="nullclines-1" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="nullclines-1"><span class="header-section-number">4.3.3</span> Nullclines</h3>
<p>The nullclines for <a href="#eq-competitionnondim">Equation&nbsp;<span>4.7</span></a> are straight lines given by</p>
<p><span class="math display">\[
n_1=0 \ \ \ \ \ n_2=\frac{1-n_1}{a_{12}},
\]</span></p>
<p>and</p>
<p><span class="math display">\[
n_2=0 \ \  \ \  \ n_2= 1-a_{21}n_1.
\]</span></p>
<p>Note that the steady states <span class="math inline">\((0,0)\)</span>, <span class="math inline">\((1,0)\)</span> and <span class="math inline">\((0,1)\)</span> are always biologically relevant (i.e.&nbsp;independently of the parameter values for <span class="math inline">\(a_{12}\)</span> and <span class="math inline">\(a_{21}\)</span>).</p>
<p>However, the coexistence steady state is only biologically relevant if the nullclines intersect in the positive quadrant and this occurs only in certain regions of the model’s parameter space.</p>
<p>In the cases where <span class="math inline">\(a_{12},a_{21}&lt;1\)</span> and <span class="math inline">\(a_{12},a_{21}&gt;1\)</span> there is a coexistence steady state (i.e.&nbsp;the nullclines intersect in the positive quadrant).</p>
<p>However, if <span class="math inline">\(a_{21}&lt;1\)</span> and <span class="math inline">\(a_{12}&gt;1\)</span> or <span class="math inline">\(a_{12}&lt;1\)</span> and <span class="math inline">\(a_{21}&gt;1\)</span> there is not a biologically relevant, coexistence steady state (i.e.&nbsp;the nullclines do not intersect in the positive quadrant).</p>
<p>Hence there are are four qualitatively different types of solution to consider.</p>
</section>
<section id="linear-stability-1" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="linear-stability-1"><span class="header-section-number">4.3.4</span> Linear stability</h3>
<p>The linear stability of the different steady states is determined by calculating the Jacobian matrix</p>
<p><span class="math display">\[
A=\left(\begin{array}{rr}
\frac{\partial f}{\partial n_1}&amp;\frac{\partial f}{\partial n_2} \\ \frac{\partial g}{\partial n_1 }&amp;\frac{\partial g}{\partial n_2} \end{array}\right)_{({n_1}^*,{n_2}^*)} = \left(\begin{array}{rr}
1-2n_1 -a_{12}n_2&amp;-a_{12}n_1 \\ -\rho a_{21}n_2 &amp;\rho(1-2n_2-a_{21}n_1)\end{array}\right)_{({n_1}^*,{n_2}^*)}.
\]</span></p>
<p>At (0,0)</p>
<p><span class="math display">\[
A=\left(\begin{array}{rr}
1&amp; 0 \\ 0 &amp; \rho\end{array}\right).
\]</span></p>
<p>Hence the eigenvalues of the Jacobian are <span class="math inline">\(1\)</span> and <span class="math inline">\(\rho\)</span>. As <span class="math inline">\(\rho&gt;0\)</span>, the origin is therefore an unstable node (there are two real positive eigenvalues).</p>
<p>At (1,0)</p>
<p><span class="math display">\[
A=\left(\begin{array}{rr}
-1&amp; -a_{12} \\ 0 &amp; \rho(1-a_{21})\end{array}\right).
\]</span></p>
<p>The trace and determinant are given by</p>
<p><span class="math display">\[
\det{A}=\rho  (a_{21}-1)\ \ \ \textrm{and} \ \ \ \mathrm{tr}{A}=-1+\rho(1-a_{21}).
\]</span></p>
<p>Hence if <span class="math inline">\(a_{21}&lt;1\)</span>, <span class="math inline">\(\det{A}&lt;0\)</span> and (1,0) is a saddle point and thus unstable (see Figure <span class="math inline">\(\ref{TDplane}\)</span>).</p>
<p>If <span class="math inline">\(a_{21}&gt;1\)</span>, <span class="math inline">\(\det{A}&gt;0\)</span> and <span class="math inline">\(\mathrm{tr}{A}&lt;0\)</span>. Hence (1,0) is a stable node.</p>
<p>Hence the parameter <span class="math inline">\(a_{21}\)</span>, which describes how strongly Population 1 inhibits the growth rate of Population 2, determines whether or not the steady state representing extinction of Population 2 but not Population 1 is stable or not.</p>
<p>At (0,1)</p>
<p><span class="math display">\[
A=\left(\begin{array}{rr}
1-a_{12}&amp; 0\\  -\rho a_{21} &amp; -\rho \end{array}\right).
\]</span></p>
<p>In this case if <span class="math inline">\(a_{12}&lt;1\)</span>, <span class="math inline">\(\det{A}&lt;0\)</span> and (0,1) is a saddle point. If <span class="math inline">\(a_{12}&gt;1\)</span>, <span class="math inline">\(\det{A}&gt;0\)</span> and <span class="math inline">\(\mathrm{tr}{A}&lt;0\)</span> and (0,1) is a stable node. Hence the parameter <span class="math inline">\(a_{12}\)</span>, which describes how strongly Population 2 inhibits the growth rate of Population 1, determines whether or not the steady state representing extinction of Population 1 but not Population 2 is stable or not.</p>
<p>At the coexistence steady state, recall the steady state is</p>
<p><span class="math display">\[
\left(\frac{1-a_{12}}{1-a_{12}a_{21}},\frac{1-a_{21}}{1-a_{12}a_{21}}\right).
\]</span> Note that this steady state is only biologically relevant in the cases <span class="math inline">\(a_{21}&lt;1, a_{12}&lt;1\)</span> or <span class="math inline">\(a_{21}&gt;1, a_{12}&gt;1\)</span>. Evaluating the Jacobian yields <span class="math display">\[
A=\frac{1}{1-a_{12}a_{21}}\left(\begin{array}{rr}
a_{12}-1  &amp; -a_{12}(1-a_{12})\\ -\rho a_{21}(1-a_{21}) &amp;\rho(a_{21}-1)\end{array}\right).
\]</span></p>
<p>The determinant and trace of the Jacobian are given by</p>
<p><span class="math display">\[
\begin{aligned}
\det{A}&amp;=\rho\left((a_{12}-1)(a_{21}-1)-a_{12}a_{21}(1-a_{12})(1-a_{21})\right)\frac{1}{(1-a_{12}a_{21})^2}, \nonumber \\
&amp;= \rho\frac{(a_{12}-1)(a_{21}-1)}{(1-a_{12}a_{21})},
\end{aligned}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mathrm{tr}{A}=\left(a_{12}-1+\rho(a_{21}-1)\right) \frac{1}{1-a_{12}a_{21}},
\]</span> respectively. \stwriting{</p>
<p>Let’s firstly consider the case where <span class="math inline">\(a_{21}&lt;1\)</span> and <span class="math inline">\(a_{21}&lt;1\)</span>. This implies that <span class="math inline">\(a_{21}-1&lt;0\)</span> and <span class="math inline">\(a_{12}-1&lt;0\)</span>, hence evaluating the signs of the different products yields</p>
<p><span class="math display">\[
\det{A} = \rho(-)(-)(+)&gt;0
\]</span> and <span class="math display">\[
\mathrm{tr}{A}= \rho(-) + (-)&lt;0.
\]</span></p>
<p>Therefore the coexistence steady state is a stable node or spiral.</p>
<p>In the case where <span class="math inline">\(a_{21}&gt;1\)</span> and $a_{12}&gt;1</p>
<p><span class="math display">\[
\det{A} = \rho(+)(+)(-)&lt;0 .
\]</span></p>
<p>Hence the coexistence steady state is a saddle.</p>
</section>
<section id="phase-portrait" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="phase-portrait"><span class="header-section-number">4.3.5</span> Phase portrait</h3>
<p>See Figure <a href="#fig-comp-numsol-phplane">Figure&nbsp;<span>4.4</span></a> for phase portraits of three of the four cases that we have considered. It is expected that you can sketch phase portraits. Key details to consider are the steady states and their linear stability. You should also sketch the nullclines and depict the sign of the derivatives in the phase plane on either side of the nullclines. You should also sketch one or more sample trajectories.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>rho<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>a_12<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>a_21<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs_comp_model(x,t):</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  rhs<span class="op">=</span>np.zeros_like(x)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  n_1<span class="op">=</span>x[<span class="dv">0</span>]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  n_2<span class="op">=</span>x[<span class="dv">1</span>]</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  dn_1_dt<span class="op">=</span>n_1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>n_1)<span class="op">-</span>a_12<span class="op">*</span>n_1<span class="op">*</span>n_2</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  dn_2_dt<span class="op">=</span>rho<span class="op">*</span>(n_2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>n_2)<span class="op">-</span>a_21<span class="op">*</span>n_1<span class="op">*</span>n_2)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  rhs[<span class="dv">0</span>]<span class="op">=</span>dn_1_dt</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  rhs[<span class="dv">1</span>]<span class="op">=</span>dn_2_dt</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> rhs</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>init_cond<span class="op">=</span>[<span class="fl">0.5</span>,<span class="fl">0.5</span>]</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> odeint(rhs_comp_model, init_cond,t)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>n_1<span class="op">=</span>sol1[:,<span class="dv">0</span>]</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>n_2<span class="op">=</span>sol1[:,<span class="dv">1</span>]</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>plt.plot(t, n_1, <span class="st">'b'</span>,t,n_2,<span class="st">'r'</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'$n_1$'</span>,<span class="st">'$n_2$'</span>],loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'t'</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-compete-numsol" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ContinuousTimeTwoSepcies_files/figure-html/fig-compete-numsol-output-1.png" width="588" height="429" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.3: Numerical solutions of competition model</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>n_1_vec<span class="op">=</span>np.linspace(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">100</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ComputeCompetitionSol(a_12,a_21,n_1_vec):</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    init_cond1<span class="op">=</span>[<span class="fl">0.75</span>,<span class="fl">0.75</span>]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    init_cond2<span class="op">=</span>[<span class="fl">0.15</span>,<span class="fl">0.15</span>]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    init_cond3<span class="op">=</span>[<span class="fl">2.5</span>,<span class="fl">0.5</span>]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">2.0</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    sol1 <span class="op">=</span> odeint(rhs_comp_model, init_cond1,t)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    sol2 <span class="op">=</span> odeint(rhs_comp_model, init_cond2,t)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    sol3 <span class="op">=</span> odeint(rhs_comp_model, init_cond3,t)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    num_steady_states<span class="op">=</span><span class="dv">3</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    fourth_ss_condition<span class="op">=</span> ((a_12<span class="op">&lt;</span><span class="dv">1</span>) <span class="op">&amp;</span> (a_21<span class="op">&lt;</span><span class="dv">1</span>)) <span class="op">|</span> ((a_12<span class="op">&gt;</span><span class="dv">1</span>) <span class="op">&amp;</span> (a_21<span class="op">&gt;</span><span class="dv">1</span>))</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fourth_ss_condition<span class="op">==</span><span class="va">True</span>:</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        num_steady_states<span class="op">=</span><span class="dv">4</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    ss<span class="op">=</span>np.zeros((num_steady_states,<span class="dv">2</span>),dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    ss[<span class="dv">0</span>,:]<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    ss[<span class="dv">1</span>,:]<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">0</span>]</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    ss[<span class="dv">2</span>,:]<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fourth_ss_condition<span class="op">==</span><span class="va">True</span>:</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        ss[<span class="dv">3</span>,:]<span class="op">=</span>[(<span class="dv">1</span><span class="op">-</span>a_12)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>a_12<span class="op">*</span>a_21),(<span class="dv">1</span><span class="op">-</span>a_21)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>a_12<span class="op">*</span>a_21)]</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    n1_ncline_1_n_1<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">0</span>]    </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    n1_ncline_1_n_2<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">5</span>]   </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    n1_ncline_2_n_2<span class="op">=</span><span class="dv">1</span><span class="op">/</span>a_12<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>n_1_vec)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    n2_ncline_1_n_1<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">5</span>]    </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    n2_ncline_1_n_2<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">0</span>]   </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    n2_ncline_2_n_2<span class="op">=</span><span class="dv">1</span><span class="op">-</span>a_21<span class="op">*</span>(n_1_vec)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sol1,sol2,sol3,ss,n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>a_12<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>a_21<span class="op">=</span><span class="fl">0.4</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>sol1,sol2,sol3,ss, n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2<span class="op">=</span>ComputeCompetitionSol(a_12,a_21,n_1_vec)</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(n1_ncline_1_n_1,n1_ncline_1_n_2,<span class="st">'k--'</span>)</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(n_1_vec,n1_ncline_2_n_2,<span class="st">'k--'</span>)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(n2_ncline_1_n_1,n2_ncline_1_n_2,<span class="st">'r--'</span>)</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(n_1_vec,n2_ncline_2_n_2,<span class="st">'r--'</span>)</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(sol1[:,<span class="dv">0</span>],sol1[:,<span class="dv">1</span>],sol2[:,<span class="dv">0</span>],sol2[:,<span class="dv">1</span>],sol3[:,<span class="dv">0</span>],sol3[:,<span class="dv">1</span>])</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(ss[:,<span class="dv">0</span>],ss[:,<span class="dv">1</span>],<span class="st">'k*'</span>)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$n_1$'</span>)</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$n_2$'</span>)</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlim([<span class="op">-</span><span class="fl">0.05</span>,<span class="fl">1.5</span>])</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim([<span class="op">-</span><span class="fl">0.05</span>,<span class="fl">1.5</span>])</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>a_12<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>a_21<span class="op">=</span><span class="fl">0.4</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>sol1,sol2,sol3,ss, n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2<span class="op">=</span>ComputeCompetitionSol(a_12,a_21,n_1_vec)</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(n1_ncline_1_n_1,n1_ncline_1_n_2,<span class="st">'k--'</span>)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(n_1_vec,n1_ncline_2_n_2,<span class="st">'k--'</span>)</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(n2_ncline_1_n_1,n2_ncline_1_n_2,<span class="st">'r--'</span>)</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(n_1_vec,n2_ncline_2_n_2,<span class="st">'r--'</span>)</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(sol1[:,<span class="dv">0</span>],sol1[:,<span class="dv">1</span>],sol2[:,<span class="dv">0</span>],sol2[:,<span class="dv">1</span>],sol3[:,<span class="dv">0</span>],sol3[:,<span class="dv">1</span>])</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(ss[:,<span class="dv">0</span>],ss[:,<span class="dv">1</span>],<span class="st">'k*'</span>)</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$n_1$'</span>)</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$n_2$'</span>)</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlim([<span class="op">-</span><span class="fl">0.05</span>,<span class="fl">1.5</span>])</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylim([<span class="op">-</span><span class="fl">0.05</span>,<span class="fl">1.5</span>])</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-comp-numsol-phplane" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ContinuousTimeTwoSepcies_files/figure-html/fig-comp-numsol-phplane-output-1.png" width="581" height="429" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.4: Numerical solution of the competition model</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="insight" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="insight"><span class="header-section-number">4.3.6</span> Insight</h3>
<p>The model therefore has four qualitatively different behaviours that are described as follows: Consider the case where <span class="math inline">\(a_{21}&gt;1\)</span>. This represents the case of Population 1 strongly competing with Population 2.</p>
<ul>
<li>If <span class="math inline">\(a_{12}&gt;1\)</span>, Population 2 also strongly competes with Population 1. In this case, there are four biologically relevant steady states, two of which are stable (1,0) and (0,1). The coexistence steady state is a saddle and thus unstable. The model is bistable and the initial conditions determine whether solutions end up at (1,0) or (0,1) (see Figure <span class="math inline">\(\ref{CompetitionPhasePlanes}\)</span> (c)). The biological interpretation of this solution is that one species will always win and completely outcompete the other. Even if the two populations are equal (<span class="math inline">\(K_1=K_2\)</span> and <span class="math inline">\(a_{21}=a_{12}&gt;1\)</span>), one species will always win and the other will become extinct.</li>
<li>If <span class="math inline">\(a_{12}&lt;1\)</span>, Population 2 weakly competes with Population 1. There is no coexistence steady state and the only stable steady state is (1,0). Hence Population 1 always wins and Population 2 always becomes extinct.</li>
</ul>
<p>Now consider the case where <span class="math inline">\(a_{21}&lt;1\)</span>. This represents the case of Population 1 weakly competing with Population 2.</p>
<ul>
<li>If <span class="math inline">\(a_{12}&gt;1\)</span>, Population 2 strongly competes with Population 1. There is nonexistence steady state and the only stable steady state is (0,1). Hence Population 2 always wins and Population 1 always becomes extinct.</li>
<li>If <span class="math inline">\(a_{12}&lt;1\)</span>, Population 2 also weakly competes with Population 1. The coexistence steady state is stable and the steady states (1,0) and (0,1) are unstable.</li>
</ul>
</section>
</section>
<section id="symbiosismutualism" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="symbiosismutualism"><span class="header-section-number">4.4</span> Symbiosis/Mutualism</h2>
<p>When the interactions between two species results in mutually benefit, it is known as mutualism or symbiosis. To study this behaviour, we consider a model of the form <span class="math display">\[
\begin{aligned}
\frac{d N_1}{dt} &amp;= r_1N_1\left(1-\frac{N_1}{K_1}+b_{12}\frac{N_2}{K_1}\right), \nonumber \\
\frac{d N_2}{dt} &amp;= r_2N_2\left(1-\frac{N_2}{K_2}+b_{21}\frac{N_1}{K_2}\right).
\end{aligned}
\]</span> Note the only difference with the competition model is that the sign of the interaction term has changed. Hence we will not work through all the details as the analysis is the same as before.</p>
<section id="nondimensionalisation-2" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="nondimensionalisation-2"><span class="header-section-number">4.4.1</span> Nondimensionalisation</h3>
<p>Using the same nondimensionalisation as the competition model, we obtain the nondimensional equations <span id="eq-mutualismnondim"><span class="math display">\[\begin{aligned}
\frac{d n_1}{d\tau} &amp;= n_1(1- n_1+a_{12}n_2) = f(n_1,n_2), \nonumber \\
\frac{d n_2}{d\tau} &amp;= \rho n_2(1-n_2+a_{21}n_1) =g(n_1,n_2).
\end{aligned}
\tag{4.8}\]</span></span></p>
</section>
<section id="steady-states-3" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="steady-states-3"><span class="header-section-number">4.4.2</span> Steady states</h3>
<p>This model has steady-states <span class="math inline">\((0,0)\)</span>, <span class="math inline">\((1,0)\)</span>,<span class="math inline">\((0,1)\)</span> and<br>
<span class="math display">\[
\left({n_1}^*,{n_2}^*\right)=\left(\frac{1+a_{12}}{1-a_{12}a_{21}},\frac{1+a_{21}}{1-a_{12}a_{21}}\right).
\]</span> The coexistence steady state is biological relevant if <span class="math inline">\(a_{12}a_{21}&lt;1\)</span></p>
</section>
<section id="nullclines-2" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="nullclines-2"><span class="header-section-number">4.4.3</span> Nullclines</h3>
<p>The <span class="math inline">\(n_1\)</span> nullclines satisfy <span class="math display">\[
n_1=0, \ \ \ n_2=\frac{1}{a_{12}}(n_1-1).
\]</span> The <span class="math inline">\(n_2\)</span> nullclines satisfy <span class="math display">\[
n_2=0, \ \ \ n_2=1+a_{21}n_1.
\]</span> Note that both nullclines have a positive slope.</p>
</section>
<section id="linear-stability-2" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="linear-stability-2"><span class="header-section-number">4.4.4</span> Linear stability</h3>
<p>Using a similar analysis to the competition model, it can be shown that the steady states (0,0), (1,0) and (0,1) are unstable. When <span class="math inline">\(a_{12}a_{21}&lt;1\)</span> there is a stable coexistence steady state. See <a href="#fig-sym-numsol-phplane">Figure&nbsp;<span>4.5</span></a>.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>n_1_vec<span class="op">=</span>np.linspace(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">100</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs_sym_model(x,t):</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  rhs<span class="op">=</span>np.zeros_like(x)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  n_1<span class="op">=</span>x[<span class="dv">0</span>]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  n_2<span class="op">=</span>x[<span class="dv">1</span>]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  dn_1_dt<span class="op">=</span>n_1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>n_1)<span class="op">+</span>a_12<span class="op">*</span>n_1<span class="op">*</span>n_2</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  dn_2_dt<span class="op">=</span>rho<span class="op">*</span>(n_2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>n_2)<span class="op">+</span>a_21<span class="op">*</span>n_1<span class="op">*</span>n_2)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  rhs[<span class="dv">0</span>]<span class="op">=</span>dn_1_dt</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  rhs[<span class="dv">1</span>]<span class="op">=</span>dn_2_dt</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> rhs</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ComputeSymbiosisSol(a_12,a_21,n_1_vec):</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">1000</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    init_cond1<span class="op">=</span>[<span class="fl">0.75</span>,<span class="fl">0.75</span>]</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    init_cond2<span class="op">=</span>[<span class="fl">0.15</span>,<span class="fl">0.15</span>]</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    init_cond3<span class="op">=</span>[<span class="fl">2.5</span>,<span class="fl">0.5</span>]</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">2.0</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    sol1 <span class="op">=</span> odeint(rhs_sym_model, init_cond1,t)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    sol2 <span class="op">=</span> odeint(rhs_sym_model, init_cond2,t)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    sol3 <span class="op">=</span> odeint(rhs_sym_model, init_cond3,t)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    num_steady_states<span class="op">=</span><span class="dv">3</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    fourth_ss_condition<span class="op">=</span> ((a_12<span class="op">*</span>a_21<span class="op">&lt;</span><span class="dv">1</span>))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fourth_ss_condition<span class="op">==</span><span class="va">True</span>:</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        num_steady_states<span class="op">=</span><span class="dv">4</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    ss<span class="op">=</span>np.zeros((num_steady_states,<span class="dv">2</span>),dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    ss[<span class="dv">0</span>,:]<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    ss[<span class="dv">1</span>,:]<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">0</span>]</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    ss[<span class="dv">2</span>,:]<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fourth_ss_condition<span class="op">==</span><span class="va">True</span>:</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>        ss[<span class="dv">3</span>,:]<span class="op">=</span>[(<span class="dv">1</span><span class="op">+</span>a_12)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>a_12<span class="op">*</span>a_21),(<span class="dv">1</span><span class="op">+</span>a_21)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>a_12<span class="op">*</span>a_21)]</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    n1_ncline_1_n_1<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">0</span>]    </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    n1_ncline_1_n_2<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">5</span>]   </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    n1_ncline_2_n_2<span class="op">=</span><span class="dv">1</span><span class="op">/</span>a_12<span class="op">*</span>(n_1_vec<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    n2_ncline_1_n_1<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">5</span>]    </span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    n2_ncline_1_n_2<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">0</span>]   </span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    n2_ncline_2_n_2<span class="op">=</span><span class="dv">1</span><span class="op">+</span>a_21<span class="op">*</span>(n_1_vec)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sol1,sol2,sol3,ss,n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>a_12<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>a_21<span class="op">=</span><span class="fl">0.4</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>sol1,sol2,sol3,ss, n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2<span class="op">=</span>ComputeSymbiosisSol(a_12,a_21,n_1_vec)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(n1_ncline_1_n_1,n1_ncline_1_n_2,<span class="st">'k--'</span>)</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(n_1_vec,n1_ncline_2_n_2,<span class="st">'k--'</span>)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(n2_ncline_1_n_1,n2_ncline_1_n_2,<span class="st">'r--'</span>)</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(n_1_vec,n2_ncline_2_n_2,<span class="st">'r--'</span>)</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(sol1[:,<span class="dv">0</span>],sol1[:,<span class="dv">1</span>],sol2[:,<span class="dv">0</span>],sol2[:,<span class="dv">1</span>],sol3[:,<span class="dv">0</span>],sol3[:,<span class="dv">1</span>])</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(ss[:,<span class="dv">0</span>],ss[:,<span class="dv">1</span>],<span class="st">'k*'</span>)</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$n_1$'</span>)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$n_2$'</span>)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlim([<span class="op">-</span><span class="fl">0.05</span>,<span class="fl">2.5</span>])</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim([<span class="op">-</span><span class="fl">0.05</span>,<span class="fl">2.5</span>])</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>a_12<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>a_21<span class="op">=</span><span class="fl">0.8</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>sol1,sol2,sol3,ss, n1_ncline_1_n_1,n1_ncline_1_n_2,n1_ncline_2_n_2,n2_ncline_1_n_1,n2_ncline_1_n_2,n2_ncline_2_n_2<span class="op">=</span>ComputeSymbiosisSol(a_12,a_21,n_1_vec)</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(n1_ncline_1_n_1,n1_ncline_1_n_2,<span class="st">'k--'</span>)</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(n_1_vec,n1_ncline_2_n_2,<span class="st">'k--'</span>)</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(n2_ncline_1_n_1,n2_ncline_1_n_2,<span class="st">'r--'</span>)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(n_1_vec,n2_ncline_2_n_2,<span class="st">'r--'</span>)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(sol1[:,<span class="dv">0</span>],sol1[:,<span class="dv">1</span>],sol2[:,<span class="dv">0</span>],sol2[:,<span class="dv">1</span>],sol3[:,<span class="dv">0</span>],sol3[:,<span class="dv">1</span>])</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(ss[:,<span class="dv">0</span>],ss[:,<span class="dv">1</span>],<span class="st">'k*'</span>)</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$n_1$'</span>)</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$n_2$'</span>)</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlim([<span class="op">-</span><span class="fl">0.05</span>,<span class="fl">2.5</span>])</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylim([<span class="op">-</span><span class="fl">0.05</span>,<span class="fl">2.5</span>])</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/pmurray/anaconda3/lib/python3.11/site-packages/scipy/integrate/_odepack_py.py:248: ODEintWarning:

Excess work done on this call (perhaps wrong Dfun type). Run with full_output = 1 to get quantitative information.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-sym-numsol-phplane" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ContinuousTimeTwoSepcies_files/figure-html/fig-sym-numsol-phplane-output-2.png" width="571" height="434" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.5: Numerical solution of the symbiosis model</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="insight-1" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="insight-1"><span class="header-section-number">4.4.5</span> Insight</h3>
<p>The important parameter in the model is the product <span class="math inline">\(a_{12}a_{21}\)</span>. This quantifies the total amount of cooperativity in the model. All steady states that involve the extinction of a species are unstable. In the case where if <span class="math inline">\(a_{12}a_{21}&lt;1\)</span> there is a stable steady state. Note that steady states of both variables are higher than they would be in the absence of the other species. In the <span class="math inline">\(a_{12}a_{21}&gt;1\)</span> there is no coexistence steady state and both populations grow in an unbounded manner.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./SinglePopODEMOdels.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Single species population dynamics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>